<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <p>Install Docker: The following steps can be used to setup NVIDIA Container Toolkit on Ubuntu LTS - 16.04, 18.04, 20.4 and Debian - Stretch, Buster distributions <sup id="fnref:guide" role="doc-noteref"><a href="#fn:guide" class="footnote" rel="footnote">1</a></sup>:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl https://get.docker.com | sh <span class="se">\</span>
  <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>systemctl <span class="nt">--now</span> <span class="nb">enable </span>docker
<span class="nb">sudo </span>usermod <span class="nt">-aG</span> docker <span class="nv">$USER</span>
</code></pre></div></div> <p>Setting up NVIDIA Container Toolkit (after system reboot):</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>distribution=$(. /etc/os-release;echo $ID$VERSION_ID) \
   &amp;&amp; curl -s -L https://nvidia.github.io/nvidia-docker/gpgkey | sudo apt-key add - \
   &amp;&amp; curl -s -L https://nvidia.github.io/nvidia-docker/$distribution/nvidia-docker.list | sudo tee /etc/apt/sources.list.d/nvidia-docker.list
</code></pre></div></div> <p>To enable <code class="language-plaintext highlighter-rouge">CUDA on WSL</code> and <code class="language-plaintext highlighter-rouge">MIG</code>, refer to the guide <sup id="fnref:guide:1" role="doc-noteref"><a href="#fn:guide" class="footnote" rel="footnote">1</a></sup>. Install the <code class="language-plaintext highlighter-rouge">nvidia-docker2</code> package:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt-get update
<span class="nb">sudo </span>apt-get <span class="nb">install</span> <span class="nt">-y</span> nvidia-docker2
<span class="nb">sudo </span>systemctl restart docker
</code></pre></div></div> <p>Now test the installation:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run <span class="nt">--rm</span> <span class="nt">--gpus</span> all nvidia/cuda:11.1.1-base nvidia-smi
</code></pre></div></div> <p>Tensorflow containers requires special arguments to bypass the system limit (increasing shared memory):</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run <span class="se">\</span>
<span class="nt">--gpus</span> all <span class="nt">-it</span> <span class="se">\</span>
<span class="nt">--shm-size</span><span class="o">=</span>1g <span class="nt">--ulimit</span> <span class="nv">memlock</span><span class="o">=</span><span class="nt">-1</span> <span class="se">\</span>
<span class="nt">--ulimit</span> <span class="nv">stack</span><span class="o">=</span>6710886 <span class="se">\</span>
nvcr.io/nvidia/tensorflow:19.06-py3
</code></pre></div></div> <h2 id="reference">Reference</h2> <div class="footnotes" role="doc-endnotes"> <ol> <li id="fn:guide" role="doc-endnote"> <p>https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/install-guide.html#docker <a href="#fnref:guide" class="reversefootnote" role="doc-backlink">↩</a> <a href="#fnref:guide:1" class="reversefootnote" role="doc-backlink">↩<sup>2</sup></a></p> </li> </ol> </div> </body></html>